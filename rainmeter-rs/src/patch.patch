--- a/src/lib.rs
+++ b/src/lib.rs
@@ impl RainmeterContext {
-    pub fn read_string(&self, key: &str, default: &str) -> String {
-        let k = to_pcwstr(key);
-        let d = to_pcwstr(default);
-        let ptr = unsafe { RmReadString(self.raw, k, d, BOOL(1)) };
-        unsafe { from_pcwstr(ptr) }
-    }
+    pub fn read_string(&self, key: &str, default: &str) -> String {
+        let k = to_pcwstr(key);
+        let d = to_pcwstr(default);
+        // FFI expects *const u16, and replaceMeasures as a plain i32
+        let raw_ptr = unsafe {
+            RmReadString(
+                self.raw,
+                k.0,
+                d.0,
+                1,           // TRUE
+            )
+        };
+        // Wrap it back so our from_pcwstr() still works
+        unsafe { from_pcwstr(PCWSTR(raw_ptr)) }
+    }

     pub fn read_string_section(&self, section: &str, key: &str, default: &str) -> String {
         let s = to_pcwstr(section);
         let k = to_pcwstr(key);
         let d = to_pcwstr(default);
-        let ptr = unsafe { RmReadStringFromSection(self.raw, s, k, d, BOOL(1)) };
-        unsafe { from_pcwstr(ptr) }
+        let raw_ptr = unsafe {
+            RmReadStringFromSection(
+                self.raw,
+                s.0,
+                k.0,
+                d.0,
+                1,
+            )
+        };
+        unsafe { from_pcwstr(PCWSTR(raw_ptr)) }
     }

     pub fn read_formula(&self, key: &str, default: f64) -> f64 {
         let k = to_pcwstr(key);
-        unsafe { RmReadFormula(self.raw, k, default) }
+        unsafe {
+            RmReadFormula(
+                self.raw,
+                k.0,
+                default,
+            )
+        }
     }

     pub fn read_formula_section(&self, section: &str, key: &str, default: f64) -> f64 {
         let s = to_pcwstr(section);
         let k = to_pcwstr(key);
-        unsafe { RmReadFormulaFromSection(self.raw, s, k, default) }
+        unsafe {
+            RmReadFormulaFromSection(
+                self.raw,
+                s.0,
+                k.0,
+                default,
+            )
+        }
     }

@@ impl RainmeterContext {
     pub fn replace_variables(&self, input: &str) -> String {
         let i = to_pcwstr(input);
-        let ptr = unsafe { RmReplaceVariables(self.raw, i) };
-        unsafe { from_pcwstr(ptr) }
+        let raw_ptr = unsafe { RmReplaceVariables(self.raw, i.0) };
+        unsafe { from_pcwstr(PCWSTR(raw_ptr)) }
     }

     pub fn path_to_absolute(&self, relative: &str) -> String {
         let r = to_pcwstr(relative);
-        let ptr = unsafe { RmPathToAbsolute(self.raw, r) };
-        unsafe { from_pcwstr(ptr) }
+        let raw_ptr = unsafe { RmPathToAbsolute(self.raw, r.0) };
+        unsafe { from_pcwstr(PCWSTR(raw_ptr)) }
     }

@@ impl RainmeterContext {
     pub fn execute(&self, command: &str) {
         let c = to_pcwstr(command);
-        unsafe { RmExecute(self.raw, c) };
+        unsafe {
+            RmExecute(
+                self.raw,
+                c.0,
+            )
+        };
     }

@@ impl RainmeterContext {
     pub fn log(&self, level: RmLogLevel, message: &str) {
         let m = to_pcwstr(message);
-        unsafe { RmLog(self.raw, level as i32, m) };
+        unsafe {
+            RmLog(
+                self.raw,
+                level as i32,
+                m.0,
+            )
+        };
     }
 }
